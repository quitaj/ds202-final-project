---
editor_options: 
  markdown: 
    wrap: 72
---

## Libraries and loading data

```{r}
library(tidyverse)
library(stringr)
df = read.csv("https://raw.githubusercontent.com/wagstrom/ds-202-final-project/main/rym_top_5000_all_time.csv")
```

In this chunk we read in our data from our working repository.

## Converting to numeric

```{r}
df$Number.of.Ratings = as.numeric(gsub(",", "", df$Number.of.Ratings))
df$Ranking = as.numeric(df$Ranking)
df$Average.Rating = as.numeric(df$Average.Rating)
df$Number.of.Reviews = as.numeric(df$Number.of.Reviews)
df2 = df
```

In this chunk we set our ratings, number of ratings, rankings, and
number of reviews as numerical values instead of string values.

## Converting comma-separated strings into separate columns

```{r}
df2[c('Genre_1', 'Genre_2', 'Genre_3', 'Genre_4', 'Genre_5')] <- str_split_fixed(df2$Genres, ', ', 5)
df2[c('Desc_1', 'Desc_2', 'Desc_3', 'Desc_4', 'Desc_5', 'Desc_6', 'Desc_7', 'Desc_8',
     'Desc_9', 'Desc_10')] <- str_split_fixed(df2$Descriptors, ', ', 10)
sum(df2$Desc_10 != "")
df3 = df2
```

In this chunk we are splitting our genres and descriptors into different
columns that makes the album values less unique.

## Add column for average score, average reviews, average ratings, and number of appearances per artist

```{r}
library(lubridate)
df3 = df3 %>%
  group_by(Artist.Name) %>%
  mutate(Artist.Average.Score = mean(Average.Rating),
         Artist.Average.Reviews = mean(Number.of.Reviews),
         Artist.Average.Ratings = mean(Number.of.Ratings),
         Artist.Frequency = nrow(as.data.frame(Artist.Name))
         )

df_final = df3
```

Dealing with Dates

```{r}
Year_useful = str_sub(df_final$Release.Date,-2,-1)

library(lubridate)
Year_start = NULL
for(i in 1:5000){
  if(Year_useful[i] <  22){
    Year_start[i] = 20
    }else{
    Year_start[i] = 19
  }
}

year = data.frame(Year_start, Year_useful)

df_final$Year = paste(year$Year_start, year$Year_useful)
df_final$Year = gsub(" ", "", df_final$Year)

Month = gsub("[^a-zA-Z]", "",df_final$Release.Date )
df_final$Month = Month

Day = parse_number(str_sub(df_final$Release.Date,,2))
df_final$Day=factor(Day)
```

In this chunk we are adding columns to find the averages of scores,
reviews, number of ratings, and number of appearances for each artist.
We do this so we can compare the individual values easier.

## Summaries

```{r}
nrow(unique(as.data.frame(df_final$Album)))
  #Some albums have the same names
nrow(unique(as.data.frame(df_final$Artist.Name)))
  #2787 unique artists
nrow(unique(as.data.frame(df_final$Genre_1)))
  #453 unique primary genres
summary(df_final)
```

In this chunk we are exploring the data to see how many unique albums,
artists, and genres in the data. We also ran a summary of the dataframe
so we could view it easier.

Our project idea is as follows:

Our dataset is the list of the top 5000 rated albums on the website
rateyourmusic.com. The dataset includes the ranking, album title,
artist, release date, genre(s), descriptors, average rating, number of
ratings, number of reviews. We have several questions we'd like to
answer through statistical analysis and visualization, some of which are
listed below:

-What is the relationship between the release date and the score of the
album?

-What is the relationship between the number of reviews/ratings and the
artist? This helps determine the relative popularity of artists on this
website.

-What is the relationship between score and other variables, such as
genre, descriptors, and artist?

-How do scores for genres change over time?

**Outline of Exploration:**

-What is the relationship between the release date and the score of the
album? **Quita**

```{r}
library(ggplot2)
ggplot(df_final, aes(x=`Year` , y =`Average.Rating`, color= `Year` ))  + geom_point(size=1.25) + theme(axis.text.x = element_text(angle = 90, size = 10)) +theme(legend.position="none")
```
```
This graph shows the average score of each album by the year it was realeased and then colered it by the year so I to better visuaize it.  By doing this, I hoped to figure out which years has the best or worst scored albums. Most of the scores sit between 3.6 and 4. When looking at the graph, I see that the lowest rated album was released in 2017 whereas the best rated album was realeased in 1963. It is important to remember that these are the top rated albums on the site overall, so the ratings are not terrible but it looks like as the years increase, you see the cluster of rating moving more towards the lower end of the septrum. 

```{r}
df_final%>%group_by(Year)%>% summarise(
  Average.Score =mean(Average.Rating)
)%>% ggplot(aes(x=Year,y=Average.Score))+geom_point()+ theme(axis.text.x = element_text(angle = 90, size = 10))
```

```{r}
df_final%>% filter(
  !(Month=="")) %>%group_by(Month)%>%summarise(
  Average.Score = mean(Average.Rating),
  Year = Year
  )%>%  mutate(Month = factor(Month, levels=c("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep", "Oct","Nov","Dec")))%>%ggplot(aes(x=Month,y=Average.Score))+geom_point()
```

```{r}
df_final%>% filter(
  !(Month==""),!(Day==""))%>% group_by(Day)%>%summarise(
  Average.Score = mean(Average.Rating)
  )%>%ggplot(aes(x=Day,y=Average.Score))+geom_point()
```

```{r}
df_final%>% filter(
  !(Month==""),!(Day==""))%>% group_by(Day)%>%summarise(
  Average.Score = mean(Average.Rating),
  Month = Month
  )%>%  mutate(Month = factor(Month, levels=c("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep", "Oct","Nov","Dec")))%>%ggplot(aes(x=Day,y=Average.Score))+geom_point()+facet_wrap(~Month)
```




-What is the relationship between the number of reviews/ratings and the
artist? This helps determine the relative popularity of artists on this
website.

**Soren** \# Question 2: Who are the most well-known artists on this
website, and does that correlate with high scores?

Answering this question will involve determining the average number of
ratings/reviews per artist. This can be accomplished using mutate
statements to create two new columns, one for average number of ratings
per artist, and one for average number of reviews per artist. The number
of reviews per artist will be much lower than the number of ratings,
because writing a review takes much more time and effort than simply
providing a score from 1-5. This is not a reflection of an artist's
popularity outside the context of this website, as this is a website for
dedicated fans of music, who tend to have different tastes than the
general public.

The average number of ratings and reviews per artist from each of their
appearances on this list is already determined by the data processing
above, so the only step remaining for this question is to visualize and
communicate the results.

The plot below shows the top 10 artists by average number of ratings.
Radiohead tops the list, followed by The Velvet Underground and Nirvana.
These are all very popular mainstream artists, so there is no surprise
here. They all have very high average scores as well, indicating that
these artists are as beloved as they are famous. There are some less
well-known artists on this list as well, such as Slint and Godspeed You,
Black Emperor!, which may indicate that these artists are more popular
among music enthusiast crowds like the RateYourMusic community than
among the general public.

```{r}
# Artist popularity by ratings
df_sorted_ratings = df_final[order(-df_final$Artist.Average.Ratings),]
df_sorted_ratings = df_sorted_ratings[,c(3, 25, 27)]
df_sorted_ratings = unique(df_sorted_ratings)[1:10,]
df_sorted_ratings %>%
  ggplot(aes(x = reorder(Artist.Name, Artist.Average.Ratings), 
             y = Artist.Average.Ratings, fill = Artist.Name)) + 
  geom_bar(stat="identity") + coord_flip() + 
  theme(axis.text.x = element_text(angle = 90, size = 10, hjust = 1)) +
  theme(legend.position="none") + 
  labs(x = "Artist Name", y = "Number of Ratings") + 
  geom_text(aes(label=round(Artist.Average.Score, digit = 2), hjust = 1)) 
```

The next plot, shown below, includes the top 10 artists by average
number of reviews. Again, The Velvet Underground and Nirvana are in the
top 3, but Pink Floyd takes the third spot this time around, followed
closely by Radiohead.

There are two outliers in the top 10 in terms of score here. Both Guns
N' Roses and The Sex Pistols have a much lower average score than the
others on this list. One conclusion that could be drawn from this
statistic it that while these two artists are clearly very well known,
they are not as widely beloved among music enthusiasts as others on this
list, and their fame may somewhat overrate the quality of their music.

```{r}
# Artist popularity by reviews
df_sorted_reviews = df_final[order(-df_final$Artist.Average.Reviews),]
df_sorted_reviews = df_sorted_reviews[,c(3, 25, 26)]
df_sorted_reviews = unique(df_sorted_reviews)[1:10,]
df_sorted_reviews %>%
  ggplot(aes(x = reorder(Artist.Name, Artist.Average.Reviews), 
             y = Artist.Average.Reviews, fill = Artist.Name)) + 
  geom_bar(stat="identity") + coord_flip() + 
  theme(axis.text.x = element_text(angle = 90, size = 10, hjust = 1)) +
  theme(legend.position="none") + 
  labs(x = "Artist Name", y = "Number of Reviews") + 
  geom_text(aes(label=round(Artist.Average.Score, digit = 2), hjust = 1))
```

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

# Question: How do scores for genres change over time? 

```{r}
length(unique(df_final$Genre_1))
```

There are 435 unique genres in the dataset. This would be too much to
cover in a plot, so we will focus on the genres that occur most on the
list.

```{r}
df_final %>% group_by(Genre_1)%>% summarise(
  Average.Score = mean(Average.Rating),
  count = n()
)%>% arrange(desc(count))
```

Progressive Rock, Singer/Songwriter, Hard Bop, Film Score, Hard Rock,
Heavy Metal, and East Coast Hip Hop are the top seven genres the occur
the most on the list.

```{r}
df_final%>% filter(Genre_1 == "Progressive Rock"|
            Genre_1 == "Singer/Songwriter"|
            Genre_1 == "Hard Bop"|
            Genre_1 == "Film Score"|
            Genre_1 == "Hard Rock"|
            Genre_1 == "Heavy Metal"|
            Genre_1 == "East Coast Hip Hop"
            )%>% group_by(Genre_1 ,Year)%>% summarise(
              Average.Score = mean(Average.Rating),
              count = n()
              )%>% ggplot(aes(x = Year,y = Average.Score, group = Genre_1, color = Genre_1)) + geom_line()+ theme(axis.text.x = element_text(angle = 90, size = 10))
```

Most genre's average scores over the years appear to be fairly
consistent. Heavy Metal started out strong in 1970, but then suffered a
steep decline by the end of the decade, plateauing around 3.75. Hard
Rock had the lowest average score, and throughout the timeline barely
broke 3.8 at its highest peak. Hard bop, Film Score, Singer/Songwriter
and east coast hip hop seem to be oscillating around an average rating
of 3.8.

```{r}
df_final %>% group_by(Genre_1)%>% 
  filter(
    Genre_1 == "Progressive Rock"|
    Genre_1 == "Singer/Songwriter"|
    Genre_1 == "Hard Bop"|
    Genre_1 == "Film Score"|
    Genre_1 == "Hard Rock"|
    Genre_1 == "Heavy Metal"|
    Genre_1 == "East Coast Hip Hop"
            )%>% summarise(
  Average.Score = mean(Average.Rating),
  count = n()
  ) %>% ggplot(aes(x=reorder(Genre_1,Average.Score),y=Average.Score, fill = Genre_1))+  
  geom_bar(stat="identity")+ 
  coord_flip() + 
  geom_text(aes(label=round(Average.Score, digit = 2), hjust = 1))+
  xlab("Genre")
```

The average scores for each genre are very similar which makes sense as
we are looking at the top 5000 albums so they all should have fairly
high scores. Film Score had the highest average score with 3.81, and
Hard Rock had the lowest average score at 3.75.

```{r}
df_final%>% filter(Genre_1 == "Progressive Rock"|
            Genre_1 == "Singer/Songwriter"|
            Genre_1 == "Hard Bop"|
            Genre_1 == "Film Score"|
            Genre_1 == "Hard Rock"|
            Genre_1 == "Heavy Metal"|
            Genre_1 == "East Coast Hip Hop"
            )%>% group_by(Genre_1 ,Year)%>% summarise(
  count = n()
)%>% ggplot(aes(x = Year,y = count, group = Genre_1, color = Genre_1)) + geom_line()+ theme(axis.text.x = element_text(angle = 90, size = 10))
```

Looking at the count for the genres over time, it can be seen that from
the beginning of the 50s to the end of the 60s Hard Bop Jazz was the
dominating genre for music. The 70s is the Rock era with Progressive and
Hard Rock occurring the most with the Singer/Songwriter genre close to
the Hard Rock genre. The 80s had Heavy Metal as the genre that occurred
the most. Finally, East Coast Hip Hop is the most occurring genre for
the 90s. The Singer/Songwriter and Progressive rock genre came back a
little in the early 2000s.

To answer the question: How do Genre's scores change over time? From the
plot, the most popular genre's scores appear to oscillate over the
years, with a fairly consistent average around 3.8 for all genres.

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

-What is the relationship between score and other variables, such as
genre, descriptors, and artist? **Jasper**

By answering this question we will be able to have a better idea of how
albums are scored and what the stronger criterion are that affect scores
for each album. First we will look for the unique values of genres,
descriptors and artists to identify how many of each category we have.
Once that is accomplished, we will be using the dplyr library and
grouping the data by genre to graph it with the ggplot library. Using
these graphs we will be able to see how different categories affect
score.

# First: Identify Question

# Question: What is the relationship between score and other variables, such as genre, descriptors, and artist?

### Find the Top 10 Most Common Genres, Descriptors, and Artists

```{r}
## Genre
df_final %>% group_by(Genre_1)%>% summarise(
  count = n()
)%>% arrange(desc(count))
```

-   Progressive Rock, Singer/Songwriter, Hard Bop, Film Score, Hard
    Rock, Heavy Metal, East Coast Hip Hop, Video Game Music, Alternative
    Rock, and Progressive Metal are the top 10 most common Genres.

```{r}
## Descriptor
df_final %>% group_by(Desc_1)%>% summarise(
  count = n()
)%>% arrange(desc(count))
```

-   Male Vocals, Instrumental, Energetic, Melodic, Melancholic, Female
    Vocals, Atmostpheric, Psychedelic, Passionate, and Dark are the top
    10 most common Descriptors.

```{r}
## Artist
df_final %>% group_by(Artist.Name)%>% summarise(
  count = n()
)%>% arrange(desc(count))
```

-   Various Artists, Miles Davis, John Coltrane, Tom Waits, John
    Williams, Bob Dylan, The Beatles, Ennio Morricone, Herbie Hancock,
    Pharoah Sanders, and The Fall

### Average Score of the Top 10 Most Common Genres, Descriptors, and Artists

```{r}
## Mean of all albums in the list
mean(df_final$Average.Rating)
```

-   The average score for all albums in the list is 3.771304.

```{r}
## Average score of Top 10 Genres
df_final_genres <- df_final[df_final$Genre_1==c("Progressive Rock", "Singer/Songwriter", "Hard Bop", "Film Score", "Hard Rock", 
                                                "Heavy Metal", "East Coast Hip Hop", "Video Game Music", "Alternative Rock", "Progressive Metal"),]
mean(df_final_genres$Average.Rating)
```

-   The average score for albums with their primary genre in the top 10
    most common genre is 3.775546.

```{r}
## Average score of Top 10 Descriptors
df_final_descriptors <- df_final[df_final$Desc_1==c("male vocals", "instrumental", "energetic", "melodic", "melancholic",
                                                    "female vocals", "atmospheric", "psychedelic", "passionate", "dark"),]
mean(df_final_descriptors$Average.Rating)
```

-   The average score for albums with their primary descriptor in the
    top 10 most common descriptors is 3.771124

```{r}
## Average score of Top 10 Artists
df_final_artists <- df_final[df_final$Artist.Name=="Various Artists" |  df_final$Artist.Name=="Miles Davis" | df_final$Artist.Name=="John Coltrane" |  df_final$Artist.Name=="Tom Waits" |
                            df_final$Artist.Name=="John Williams" | df_final$Artist.Name=="Bob Dylan" | df_final$Artist.Name=="The Beatles" |  df_final$Artist.Name=="Ennio Morricone" |
                            df_final$Artist.Name=="Herbie Hancock" | df_final$Artist.Name=="Pharoah Sanders" | df_final$Artist.Name=="The Fall",]
mean(df_final_artists$Average.Rating)
```

-   The average score for albums with their artists in the top 10 most
    common artists is 3.855435.

```{r}
## Average Score of all Top 10's
df_final_top10s <- df_final[df_final$Genre_1==c("Progressive Rock", "Singer/Songwriter", "Hard Bop", "Film Score", "Hard Rock", 
                                                "Heavy Metal", "East Coast Hip Hop", "Video Game Music", "Alternative Rock", "Progressive Metal") | 
                            df_final$Desc_1==c("male vocals", "instrumental", "energetic", "melodic", "melancholic",
                                                    "female vocals", "atmospheric", "psychedelic", "passionate", "dark") | 
                            df_final$Artist.Name=="Various Artists" |  df_final$Artist.Name=="Miles Davis" | df_final$Artist.Name=="John Coltrane" |  df_final$Artist.Name=="Tom Waits" |
                            df_final$Artist.Name=="John Williams" | df_final$Artist.Name=="Bob Dylan" | df_final$Artist.Name=="The Beatles" |  df_final$Artist.Name=="Ennio Morricone" |
                            df_final$Artist.Name=="Herbie Hancock" | df_final$Artist.Name=="Pharoah Sanders" | df_final$Artist.Name=="The Fall",]
mean(df_final_top10s$Average.Rating)
```

-   The average score for an album with any of the previous top 10
    values included in the album is 3.7976607.

### Average Score of !Top 10 most common genres, descriptors, artists

```{r}
## Average score without top 10 most common Genres
df_final_genres2 <- df_final[!df_final$Genre_1==c("Progressive Rock", "Singer/Songwriter", "Hard Bop", "Film Score", "Hard Rock", 
                                                "Heavy Metal", "East Coast Hip Hop", "Video Game Music", "Alternative Rock", "Progressive Metal"),]
mean(df_final_genres2$Average.Rating)
```

-   The average score when the top 10 most common primary genres are
    removed is 3.771201.

```{r}
## Average score without top 10 most common Descriptors
df_final_descriptors2 <- df_final[!df_final$Desc_1==c("male vocals", "instrumental", "energetic", "melodic", "melancholic",
                                                    "female vocals", "atmospheric", "psychedelic", "passionate", "dark"),]
mean(df_final_descriptors2$Average.Rating)
```

-   The average score when the top 10 most common primary descriptors
    are removed is 3.771311

```{r}
## Average score without top 10 most common Artists
df_final_artists2 <- df_final[!df_final$Artist.Name=="Various Artists" &  !df_final$Artist.Name=="Miles Davis" & !df_final$Artist.Name=="John Coltrane" &  
                             !df_final$Artist.Name=="Tom Waits" & !df_final$Artist.Name=="John Williams" & !df_final$Artist.Name=="Bob Dylan" & 
                             !df_final$Artist.Name=="The Beatles" &  !df_final$Artist.Name=="Ennio Morricone" & !df_final$Artist.Name=="Herbie Hancock" & 
                             !df_final$Artist.Name=="Pharoah Sanders" & !df_final$Artist.Name=="The Fall",]
mean(df_final_artists2$Average.Rating)
```

-   The average score when the top 10 most common artists are removed is
    3.768916.

```{r}
## Average score without all top 10's
df_final_top10s2 <- df_final[!df_final$Genre_1==c("Progressive Rock", "Singer/Songwriter", "Hard Bop", "Film Score", "Hard Rock", 
                                                "Heavy Metal", "East Coast Hip Hop", "Video Game Music", "Alternative Rock", "Progressive Metal") &
                             !df_final$Desc_1==c("male vocals", "instrumental", "energetic", "melodic", "melancholic",
                                                    "female vocals", "atmospheric", "psychedelic", "passionate", "dark") &
                             !df_final$Artist.Name=="Various Artists" &  !df_final$Artist.Name=="Miles Davis" & !df_final$Artist.Name=="John Coltrane" &  
                             !df_final$Artist.Name=="Tom Waits" & !df_final$Artist.Name=="John Williams" & !df_final$Artist.Name=="Bob Dylan" & 
                             !df_final$Artist.Name=="The Beatles" &  !df_final$Artist.Name=="Ennio Morricone" & !df_final$Artist.Name=="Herbie Hancock" & 
                             !df_final$Artist.Name=="Pharoah Sanders" & !df_final$Artist.Name=="The Fall",]
mean(df_final_top10s2$Average.Rating)
```

-   The average score when the top 10 most common artists, genres, and
    descriptors are removed is 3.768879.

### Correlation matrix to find what is most correlated with score

```{r}
dummydf <- df_final

dummydf$Genre_1 <- as.numeric(factor(dummydf$Genre_1))
dummydf$Desc_1 <- as.numeric(factor(dummydf$Desc_1))
dummydf$Artist.Name <-  as.numeric(factor(dummydf$Artist.Name))
dummydf$Year <-  as.numeric(factor(dummydf$Year))
dummydf$Number.of.Ratings <-  as.numeric(factor(dummydf$Number.of.Ratings))
dummydf$Number.of.Reviews <-  as.numeric(factor(dummydf$Number.of.Reviews))

dummydf2 <- subset(dummydf, select=c("Average.Rating","Artist.Name", "Genre_1", "Desc_1", "Year", "Number.of.Ratings", "Number.of.Reviews"))
results <- cor(dummydf2)
round(results,2)
```

-   Using our correlation matrix we can see that Number.of.Reviews is
    our strongest predictor of Average Rating with Number.of.Ratings
    close behind. If we were making a model to predict the average
    rating for an album we would include the variables:
    Number.of.Reviews, Number.of.Ratings, and Year.
